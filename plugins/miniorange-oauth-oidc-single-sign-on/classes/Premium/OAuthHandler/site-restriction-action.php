<?php


function mo_oauth_client_page_restriction()
{
    ob_start();
    global $Uj;
    $Kn = $Uj->get_plugin_config();
    $ow = $Kn->get_config("\x72\x65\x73\x74\x72\x69\x63\164\137\x74\x6f\x5f\154\x6f\x67\147\x65\x64\x5f\151\x6e\137\165\163\x65\162\163");
    $ow = '' !== $ow ? $ow : false;
    $he = $Kn->get_config("\141\x75\x74\x6f\137\x72\x65\x64\x69\x72\145\143\164\x5f\145\x78\143\x6c\165\x64\145\x5f\x75\x72\x6c\x73");
    if (!(!is_user_logged_in() && boolval($ow) && !strpos($Uj->get_current_url(), "\57\163\143\151\x6d"))) {
        goto zFM;
    }
    if (!("\x50\117\x53\124" === $_SERVER["\122\105\x51\x55\x45\x53\x54\137\x4d\x45\124\110\117\x44"])) {
        goto Zs2;
    }
    return;
    Zs2:
    if (!(isset($_REQUEST["\x6f\x61\x75\164\x68\x6c\157\x67\151\x6e"]) && "\x66\141\x6c\163\x65" === $_REQUEST["\157\x61\x75\x74\150\154\x6f\147\151\x6e"] && strpos($Uj->get_current_url(), "\x2f\x77\160\x2d\154\157\x67\x69\156\56\x70\x68\x70"))) {
        goto On8;
    }
    return;
    On8:
    if (!(isset($_REQUEST[\MoOAuthConstants::OPTION]) && "\x6f\141\165\x74\x68\x72\x65\x64\151\162\x65\143\164" === $_REQUEST[\MoOAuthConstants::OPTION])) {
        goto rDU;
    }
    return;
    rDU:
    if (!(isset($_REQUEST["\143\157\x64\145"]) && '' !== $_REQUEST["\143\157\x64\x65"])) {
        goto iTt;
    }
    return;
    iTt:
    if (!(isset($_REQUEST["\141\143\x63\145\x73\x73\x5f\x74\157\153\145\156"]) && '' !== $_REQUEST["\x61\x63\x63\145\163\x73\137\164\x6f\x6b\145\x6e"])) {
        goto abK;
    }
    return;
    abK:
    if (!(isset($_REQUEST["\154\x6f\147\151\x6e"]) && "\160\x77\144\x67\x72\156\x74\146\x72\x6d" === $_REQUEST["\x6c\x6f\x67\151\156"])) {
        goto Tp9;
    }
    return;
    Tp9:
    if (!(isset($_REQUEST["\145\x72\x72\157\x72"]) && '' !== $_REQUEST["\x65\x72\x72\157\x72"] || isset($_REQUEST["\x65\162\162\157\162\137\144\145\163\x63\x72\x69\x70\164\x69\157\156"]) && '' !== $_REQUEST["\x65\x72\x72\x6f\162\x5f\x64\x65\163\x63\162\151\x70\x74\151\157\x6e"])) {
        goto Xqg;
    }
    return;
    Xqg:
    $l9 = $Uj->get_all_headers();
    if (!(isset($l9["\x41\103\x43\105\120\124"]) && "\141\160\x70\154\x69\143\x61\164\x69\x6f\156\x2f\152\163\157\x6e" === $l9["\101\103\103\105\x50\x54"])) {
        goto oCC;
    }
    return;
    oCC:
    if (empty($he)) {
        goto dgV;
    }
    $oZ = $Uj->get_current_url();
    $oZ = trim($oZ, "\x2f");
    $fu = apply_filters("\155\x6f\x5f\157\141\165\x74\150\137\x63\154\x69\x65\x6e\x74\x5f\146\157\162\143\x65\x64\x5f\154\157\147\x69\x6e\x5f\145\x78\143\x6c\165\144\145\137\165\x72\154\x73", $he, $oZ);
    if (!($fu === true)) {
        goto Hii;
    }
    return;
    Hii:
    $he = explode("\xa", $he);
    foreach ($he as $K3) {
        if (!ctype_space(substr($K3, -1))) {
            goto Xb8;
        }
        $K3 = substr_replace($K3, '', -1);
        Xb8:
        $K3 = trim(trim($K3), "\57");
        if (!(substr($K3, -1) == "\52")) {
            goto rha;
        }
        $K3 = substr_replace($K3, '', -1);
        $K3 = trim($K3, "\x2f");
        if (!(strpos($oZ, $K3) !== false)) {
            goto OjH;
        }
        return;
        OjH:
        rha:
        if (empty($K3)) {
            goto gH3;
        }
        if (!($oZ === $K3)) {
            goto Q3F;
        }
        return;
        Q3F:
        gH3:
        Wj6:
    }
    IcU:
    dgV:
    $k_ = $Uj->get_app_by_name();
    if ($k_) {
        goto S1p;
    }
    return;
    S1p:
    $gA = $k_->get_app_config("\141\146\x74\145\x72\x5f\x6c\x6f\x67\x69\x6e\x5f\x75\162\154");
    $oZ = $gA ? $gA : $Uj->get_current_url();
    $cL = '';
    $cL = apply_filters("\x6d\x6f\x5f\x6f\141\165\x74\150\x5f\x63\x75\163\x74\157\155\151\x7a\x65\137\162\x65\144\151\162\145\143\164\x69\x6f\156\137\x6d\163\x67", $cL);
    if (!empty($cL)) {
        goto Htm;
    }
    if (!empty($Uj->mo_oauth_client_get_option("\155\x6f\x5f\157\141\x75\x74\x68\137\143\154\x69\145\156\164\137\146\x6f\x72\x63\145\x64\x5f\155\x65\x73\x73\141\x67\145")) && $Uj->mo_oauth_client_get_option("\x6d\x6f\x5f\x6f\141\x75\x74\x68\137\143\x6c\x69\x65\x6e\x74\137\146\x6f\x72\143\145\x64\137\155\145\x73\163\x61\x67\145") != '') {
        goto S4f;
    }
    echo "\122\145\x64\151\x72\x65\143\x74\151\x6e\x67\x20\164\x6f\x20\144\145\x66\141\x75\x6c\x74\40\x6c\x6f\147\151\156\56\56";
    goto USB;
    Htm:
    echo $cL;
    goto USB;
    S4f:
    echo $Uj->mo_oauth_client_get_option("\x6d\157\x5f\x6f\141\165\x74\150\x5f\x63\x6c\151\x65\x6e\164\137\146\x6f\162\x63\145\144\137\x6d\145\x73\x73\141\147\x65");
    USB:
    echo "\x9\x9\x3c\x73\x63\x72\151\x70\164\x3e\15\12\11\11\11\151\x66\50\40\x77\151\156\x64\x6f\x77\56\x6c\x6f\143\x61\x74\x69\x6f\156\x2e\150\x72\x65\x66\56\x69\x6e\x64\145\x78\117\x66\x28\42\43\141\x63\143\145\x73\163\x5f\x74\x6f\153\145\156\42\51\76\x2d\61\x20\x7c\x7c\x20\x77\151\156\144\x6f\x77\56\x6c\x6f\x63\141\x74\x69\157\x6e\56\x68\162\145\x66\x2e\x69\x6e\x64\x65\170\117\x66\x28\42\43\143\157\144\x65\x22\51\76\55\x31\40\x7c\x7c\40\167\151\156\144\x6f\167\x2e\x6c\157\x63\x61\164\151\157\156\56\x68\162\x65\146\56\x69\156\x64\145\x78\x4f\x66\x28\42\43\x69\144\x5f\x74\157\153\x65\156\x22\x29\x3e\55\x31\40\x29\40\x7b\xd\xa\x9\11\x9\11\166\x61\162\40\x75\x72\154\40\75\40\167\x69\x6e\x64\157\x77\56\154\157\143\141\164\x69\157\x6e\x2e\x74\x6f\x53\164\x72\x69\156\x67\50\x29\73\15\xa\x9\x9\x9\11\167\x69\x6e\x64\x6f\167\56\154\157\143\141\x74\x69\x6f\156\x20\75\x20\x75\162\x6c\x2e\x72\145\160\154\141\x63\145\x28\x22\x23\42\x2c\x20\47\x3f\47\51\x3b\xd\xa\x9\11\11\175\40\15\12\x9\11\x9\x65\154\163\145\x20\151\x66\x28\50\167\x69\x6e\144\157\x77\56\x6c\157\x63\x61\164\x69\x6f\156\56\x68\162\145\x66\x2e\151\x6e\x64\x65\170\117\x66\50\42\x23\163\x74\x61\164\145\42\x29\x3e\x2d\61\x20\46\x26\x20\50\167\151\156\144\x6f\x77\56\154\157\143\141\x74\151\x6f\156\x2e\150\162\145\146\x2e\151\156\144\145\170\x4f\146\50\x22\x65\x72\x72\x6f\162\42\51\76\55\61\40\174\x7c\x20\x77\151\156\x64\157\x77\56\x6c\x6f\x63\x61\164\x69\157\156\x2e\x68\x72\145\146\56\151\156\144\145\x78\x4f\146\50\x22\145\x72\162\x6f\x72\x5f\x64\145\x73\x63\x72\x69\160\164\151\x6f\x6e\x22\x29\x3e\55\x31\x29\x29\x20\174\174\x20\x77\151\x6e\144\157\167\56\x6c\x6f\x63\x61\164\151\x6f\x6e\56\150\162\x65\x66\56\x69\x6e\x64\145\170\x4f\x66\x28\42\x23\x65\x72\162\157\x72\42\51\x3e\x2d\61\x20\x7c\174\x20\x77\x69\156\144\x6f\167\x2e\x6c\157\143\x61\164\x69\157\x6e\56\150\162\x65\x66\56\151\156\x64\145\170\117\146\50\x22\x23\x65\x72\x72\157\x72\x5f\x64\x65\x73\x63\162\151\x70\164\151\x6f\156\42\x29\76\55\61\x20\x29\x20\x7b\11\15\12\x9\x9\11\11\x76\x61\162\40\x75\162\154\40\75\x20\x77\151\x6e\144\157\x77\x2e\x6c\x6f\x63\x61\x74\151\157\x6e\56\164\157\123\x74\162\151\156\x67\50\x29\73\xd\xa\x9\11\11\x9\x77\x69\156\144\x6f\x77\56\154\x6f\143\x61\164\151\x6f\156\40\75\x20\x75\x72\x6c\56\162\x65\160\x6c\141\143\x65\50\x22\x23\42\x2c\x20\47\x3f\x27\x29\73\15\xa\11\x9\x9\x7d\40\x65\x6c\163\x65\40\x7b\xd\12\11\11\x9\x9\x76\x61\162\40\165\162\x6c\x20\x3d\40\x22";
    echo site_url();
    echo "\42\73\15\12\11\11\x9\x9\x75\x72\x6c\40\x3d\40\x75\162\x6c\x20\x2b\x20\x27\x2f\x3f\x6f\160\x74\151\157\x6e\75\x6f\x61\x75\x74\x68\x72\145\x64\151\162\x65\143\x74\46\141\x70\160\x5f\156\x61\x6d\x65\75\47\40\x2b\x20\x22";
    echo wp_kses($k_->get_app_name(), \mo_oauth_get_valid_html());
    echo "\x22\40\x2b\40\47\x26\162\x65\x64\x69\162\x65\x63\x74\x5f\x75\x72\154\75\47\40\53\x20\42";
    echo rawurlencode($oZ);
    echo "\x22\40\53\x20\47\46\x72\145\x73\164\162\x69\143\164\x72\x65\x64\x69\x72\x65\x63\x74\x3d\164\x72\165\145\47\73\15\12\x9\11\11\11\167\151\x6e\x64\x6f\x77\56\x6c\157\143\141\x74\151\x6f\156\56\162\x65\x70\x6c\141\x63\145\x28\40\x75\x72\154\40\x29\73\15\12\11\x9\11\x7d\xd\xa\11\x9\x3c\x2f\163\x63\x72\x69\160\x74\76\xd\xa\x9\x9";
    exit;
    zFM:
}
add_action("\151\x6e\x69\x74", "\x6d\x6f\x5f\x6f\x61\165\x74\150\137\x63\x6c\x69\x65\156\x74\x5f\160\x61\147\x65\137\162\x65\x73\x74\x72\x69\143\x74\x69\157\x6e");
